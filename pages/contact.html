<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact - Les P'tites Bouilles Villebonnaises</title>
    <link rel="stylesheet" href="../styles/styles.css">
    <link rel="stylesheet" href="../styles/contact.css">
    <link rel="stylesheet" href="../styles/faq.css">
    
    <!-- reCAPTCHA v3 Script -->
    <script src="https://www.google.com/recaptcha/api.js?render=6LcM_KGrAAAAAIAze535yP2CsRd1FVFQSXmUelvV"></script>
</head>
<body>
    <header>
        <div class="logo">
            <h1>Les p'tites bouilles villebonnaises</h1>
        </div>
        <nav>
            <ul>
                <li><a href="../index.html">Accueil</a></li>
                <li><a href="./gallery.html">Galerie</a></li>
                <li><a href="./disponibilite.html">Disponibilit√©</a></li>
                <li><a href="./agenda.html">Planning</a></li>
                <li><a href="./contact.html" class="active">Contact</a></li>
            </ul>
        </nav>
    </header>

    <section class="contact-hero">
        <div class="hero-content">
            <h2>Contactez-nous</h2>
            <p>Nous sommes √† votre √©coute pour toute question ou demande d'information</p>
        </div>
    </section>

    <section class="contact-container">
        <div class="contact-info">
            <div class="contact-card">
                <div class="contact-icon">‚úâÔ∏è</div>
                <h3>Email</h3>
                <p>nounou.villebon.les.bouilles@gmail.com</p>
            </div>
            <div class="contact-card">
                <div class="contact-icon">üìû</div>
                <h3>T√©l√©phone</h3>
                <p>06 24 24 10 64</p>
            </div>
            <div class="contact-card">
                <div class="contact-icon">üìç</div>
                <h3>Adresse</h3>
                <p>Les P'tites Bouilles Villebonnaises<br>Sandrine Jouve, Pr√©sidente</p>
                <p>1 rue Jean Moulin<br>91140 Villebon-sur-Yvette, France</p>
            </div>
        </div>

        <div class="contact-form-container">
            <h2>Envoyez-nous un message</h2>
            <form id="contactForm" class="contact-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="nom">Nom</label>
                        <input type="text" id="nom" name="nom" placeholder="Votre nom" required>
                    </div>
                    <div class="form-group">
                        <label for="prenom">Pr√©nom</label>
                        <input type="text" id="prenom" name="prenom" placeholder="Votre pr√©nom" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" placeholder="Votre email" required>
                </div>
                <div class="form-group">
                    <label for="sujet">Sujet</label>
                    <input type="text" id="sujet" name="sujet" placeholder="Sujet de votre message" required>
                </div>
                <div class="form-group">
                    <label for="message">Message</label>
                    <textarea id="message" name="message" rows="6" placeholder="Votre message" required></textarea>
                </div>
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="consentement" name="consentement" required>
                    <label for="consentement">J'accepte que mes donn√©es soient trait√©es conform√©ment √† la politique de confidentialit√©</label>
                </div>
                
                <!-- Information reCAPTCHA (obligatoire selon les conditions d'utilisation de Google) -->
                <div class="recaptcha-info">
                    Ce site est prot√©g√© par reCAPTCHA et la 
                    <a href="https://policies.google.com/privacy" target="_blank">Politique de confidentialit√©</a> et les 
                    <a href="https://policies.google.com/terms" target="_blank">Conditions d'utilisation</a> de Google s'appliquent.
                </div>
                
                <!-- OPTION 2: Badge reCAPTCHA explicite (d√©commenter si vous pr√©f√©rez cette approche) -->
                <!-- 
                <div style="text-align: center; margin: 15px 0;">
                    <div style="display: inline-block; background: #f9f9f9; padding: 8px 12px; border-radius: 3px; border: 1px solid #ccc;">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzQiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCA3NCAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTI5LjggMTcuNkMyOS44IDE3LjYgMjkuOCAxNy42IDI5LjggMTcuNkMyOS44IDE3LjYgMjkuOCAxNy42IDI5LjggMTcuNloiIGZpbGw9IiM0Mjg1RjQiLz4KPC9zdmc+" alt="reCAPTCHA" style="width: 20px; height: 20px; vertical-align: middle; margin-right: 6px;">
                        <span style="font-size: 12px; color: #555;">Prot√©g√© par <strong>reCAPTCHA</strong></span>
                    </div>
                </div>
                -->
                
                <!-- Message de statut -->
                <div id="status" style="margin: 15px 0; text-align: center; font-weight: bold; min-height: 20px;"></div>
                
                <button type="submit" id="submitBtn" class="submit-btn">Envoyer le message</button>
            </form>
        </div>
    </section>

    <section class="map-section">
        <h2>Nous trouver</h2>
        <div class="map-container">
            <div class="map-placeholder">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d603.3889357381325!2d2.235936392429429!3d48.69981559891924!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47e678767dda27fd%3A0xb4d991e72b9ec1c1!2s1%20Rue%20Jean%20Moulin%2C%2091140%20Villebon-sur-Yvette!5e1!3m2!1sfr!2sfr!4v1755003084011!5m2!1sfr!2sfr" width="100%" max-width="1200px" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>
    </section>

    <section class="faq-section">
        <h2>Questions fr√©quentes</h2>
        <div class="faq-container">
            <div class="faq-item">
                <div class="faq-question">
                    <h3>O√π se d√©roulent les activit√©s ?</h3>
                    <span class="faq-toggle">+</span>
                </div>
                <div class="faq-answer">
                    <p>La plus grande part des activit√©s se d√©roulent √† la MJC de Villebon-sur-Yvette.</p>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4>√Ä propos</h4>
                <p>Les p'tites bouilles villebonnaises sont une association loi 1901, cr√©√©e en 2013, ayant pour but la cr√©ation et l'animation d'ateliers permettant le d√©veloppement psychomoteur de l'enfant de moins de 4 ans, son √©panouissement et sa socialisation.</p>
            </div>
            <div class="footer-section">
                <h4>Contact</h4>
                <p>Email : nounou.villebon.les.bouilles@gmail.com</p>
                <p>T√©l√©phone : 06 24 24 10 64</p>
            </div>
            <div class="footer-section">
                <h4>Liens utiles</h4>
                <ul>
                    <li><a href="./mention-legale.html">Mentions l√©gales</a></li>
                    <div class="social-icons">
                        <a href="https://www.facebook.com/share/1BGpTjQ6nd/" target="_blank">
                            <img src="../assets/facebook-logo.webp" alt="Facebook">
                        </a>
                        <a href="https://instagram.com" target="_blank">
                            <img src="../assets/Instagram_icon.webp" alt="Instagram">
                        </a>
                    </div>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>2025 Les p'tites bouilles villebonnaises. Tous droits r√©serv√©s.</p>
        </div>
    </footer>

    <!-- Scripts originaux -->
    <script src="../script/contact.js"></script>
    
    <!-- Script reCAPTCHA v3 -->
    <script>
        // Configuration reCAPTCHA v3
        const RECAPTCHA_SITE_KEY = '6LcM_KGrAAAAAIAze535yP2CsRd1FVFQSXmUelvV';
        
        // Initialisation de reCAPTCHA quand la page est charg√©e
        grecaptcha.ready(function() {
            console.log('reCAPTCHA v3 initialis√© sur la page de contact');
            
            // OPTION 1: Forcer l'affichage du badge (d√©commenter si souhait√©)
            // grecaptcha.render('recaptcha-badge', {
            //     'sitekey': RECAPTCHA_SITE_KEY,
            //     'badge': 'bottomright', // 'bottomright', 'bottomleft' ou 'inline'
            //     'size': 'invisible'
            // });
        });

        // Gestion du formulaire de contact avec reCAPTCHA
        document.getElementById('contactForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const statusDiv = document.getElementById('status');
            const submitBtn = document.getElementById('submitBtn');
            
            // V√©rifier que la case de consentement est coch√©e
            const consentement = document.getElementById('consentement');
            if (!consentement.checked) {
                statusDiv.textContent = 'Veuillez accepter le traitement de vos donn√©es.';
                statusDiv.style.color = '#f44336';
                return;
            }
            
            // D√©sactiver le bouton pendant le traitement
            submitBtn.disabled = true;
            submitBtn.textContent = 'Envoi en cours...';
            statusDiv.textContent = 'V√©rification en cours...';
            statusDiv.style.color = '#666';
            
            // Ex√©cuter reCAPTCHA v3
            grecaptcha.ready(function() {
                grecaptcha.execute(RECAPTCHA_SITE_KEY, { action: 'contact_form' })
                .then(function(token) {
                    // R√©cup√©rer les donn√©es du formulaire
                    const formData = new FormData();
                    formData.append('nom', document.getElementById('nom').value);
                    formData.append('prenom', document.getElementById('prenom').value);
                    formData.append('email', document.getElementById('email').value);
                    formData.append('sujet', document.getElementById('sujet').value);
                    formData.append('message', document.getElementById('message').value);
                    formData.append('recaptcha_token', token);
                    formData.append('action', 'contact_form');
                    
                    // Envoyer les donn√©es au serveur
                    // IMPORTANT: Adaptez le chemin selon votre structure
                    fetch('../process_contact.php', {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            statusDiv.textContent = 'Message envoy√© avec succ√®s ! Nous vous r√©pondrons dans les plus brefs d√©lais.';
                            statusDiv.style.color = '#4CAF50';
                            document.getElementById('contactForm').reset();
                        } else {
                            statusDiv.textContent = 'Erreur : ' + (data.message || '√âchec de l\'envoi');
                            statusDiv.style.color = '#f44336';
                        }
                    })
                    .catch(error => {
                        console.error('Erreur:', error);
                        statusDiv.textContent = 'Erreur de connexion. Veuillez r√©essayer plus tard.';
                        statusDiv.style.color = '#f44336';
                    })
                    .finally(() => {
                        // R√©activer le bouton
                        submitBtn.disabled = false;
                        submitBtn.textContent = 'Envoyer le message';
                    });
                })
                .catch(function(error) {
                    console.error('Erreur reCAPTCHA:', error);
                    statusDiv.textContent = 'Erreur de v√©rification. Veuillez recharger la page et r√©essayer.';
                    statusDiv.style.color = '#f44336';
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Envoyer le message';
                });
            });
        });
        
        // OPTION 3: Forcer l'affichage du badge Google (d√©commenter pour activer)
        /*
        window.onload = function() {
            // Rendre le badge Google visible s'il est cach√©
            const badge = document.querySelector('.grecaptcha-badge');
            if (badge) {
                badge.style.visibility = 'visible';
                badge.style.opacity = '1';
            }
        };
        */
        
        // OPTION 4: Cr√©er un badge personnalis√©
        function showCustomRecaptchaBadge() {
            const customBadge = document.createElement('div');
            customBadge.innerHTML = `
                <div style="position: fixed; bottom: 14px; right: 14px; background: white; padding: 6px 8px; border-radius: 3px; box-shadow: 0 2px 6px rgba(0,0,0,0.3); font-size: 12px; z-index: 1000;">
                    <img src="https://www.gstatic.com/recaptcha/api2/logo_48.png" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 4px;">
                    reCAPTCHA
                </div>
            `;
            document.body.appendChild(customBadge.firstElementChild);
        }
        
        // D√©commenter la ligne suivante pour afficher le badge personnalis√©
        // showCustomRecaptchaBadge();

        // Fonction pour g√©rer les erreurs reCAPTCHA
        function onRecaptchaError() {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = 'Erreur de chargement reCAPTCHA. Veuillez v√©rifier votre connexion internet.';
            statusDiv.style.color = '#f44336';
        }
        
        // Fonction pour g√©rer l'expiration du token
        function onRecaptchaExpired() {
            console.log('Token reCAPTCHA expir√©');
        }
    </script>
</body>
</html>